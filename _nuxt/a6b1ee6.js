(window.webpackJsonp=window.webpackJsonp||[]).push([[12,13],{833:function(e,t,r){var content=r(861);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(141).default)("0dee24ef",content,!0,{sourceMap:!1})},859:function(e,t,r){var content=r(887);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(141).default)("78d4e694",content,!0,{sourceMap:!1})},860:function(e,t,r){"use strict";r(833)},861:function(e,t,r){var n=r(140)((function(i){return i[1]}));n.push([e.i,'.ol-popup[data-v-2689c761]{position:absolute;background-color:#fff;box-shadow:0 1px 4px rgba(0,0,0,.2);padding:15px;border-radius:10px;border:1px solid #ccc;bottom:12px;left:-50px;min-width:180px}.ol-popup[data-v-2689c761]:after,.ol-popup[data-v-2689c761]:before{top:100%;border:solid transparent;content:" ";height:0;width:0;position:absolute;pointer-events:none}.ol-popup[data-v-2689c761]:after{border-top-color:#fff;border-width:10px;left:48px;margin-left:-10px}.ol-popup[data-v-2689c761]:before{border-top-color:#ccc;border-width:11px;left:48px;margin-left:-11px}.ol-popup-closer[data-v-2689c761]{text-decoration:none;position:absolute;top:2px;right:8px}.ol-popup-closer[data-v-2689c761]:after{content:"✖"}',""]),n.locals={},e.exports=n},870:function(e,t,r){"use strict";r.r(t);r(68);var n={name:"OlPopover",props:{feature:{type:Object,required:!0}},methods:{close:function(e){e.target.blur(),this.$emit("close")}}},o=(r(860),r(195)),component=Object(o.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"card bg-base-100 shadow-xl ol-popup"},[t("a",{staticClass:"ol-popup-closer",attrs:{id:"popup-closer"},on:{click:e.close}}),e._v(" "),e.feature.properties?t("div",{attrs:{id:"card-body popup-content"}},[e.feature.properties.name?t("h2",{staticClass:"card-title"},[e._v("\n      "+e._s(e.feature.properties.name)+"\n    ")]):e._e(),e._v(" "),e.feature.properties.name?t("p",[e._v("\n      "+e._s(e.feature.properties.name)+"\n    ")]):e._e(),e._v(" "),e.feature.properties.count?t("p",[e._v("\n      Ocorrência: "+e._s(e._f("locateNumber")(e.feature.properties.count))+"\n    ")]):e._e(),e._v(" "),e.feature.properties.incidence?t("p",[e._v("\n      Incidência: "+e._s(e._f("locateNumber")(e.feature.properties.incidence))+"\n    ")]):e._e(),e._v(" "),e.feature.properties.populations?t("p",[e._v("\n      População: "+e._s(e._f("locateNumber")(e.feature.properties.populations))+"\n    ")]):e._e(),e._v(" "),t("div",{staticClass:"card-actions justify-end"},[t("button",{staticClass:"btn btn-xs btn-primary",on:{click:e.close}},[e._v("fechar")])])]):e._e()])}),[],!1,null,"2689c761",null);t.default=component.exports},886:function(e,t,r){"use strict";r(859)},887:function(e,t,r){var n=r(140)((function(i){return i[1]}));n.push([e.i,".map[data-v-41a7d60f]{width:100%}",""]),n.locals={},e.exports=n},939:function(e,t,r){"use strict";r.r(t);r(26),r(68),r(184),r(87),r(45),r(110),r(164),r(198),r(86);var n=r(70),o=(r(117),r(28),r(17),r(69),r(127),r(221),r(339),r(871)),c=r(864),l=r(943),d=r(938),f=r(893),h=r(937),m=r(872),v=r(926),w=r(995),y=r(793),x=(r(340),r(869),r(93),r(922)),_=r.n(x),P=r(821),S=r(844),C=r(824),M=r(825),O=r(843),F=r(817),T=r.n(F),k=r(8),I=(r(577),{props:{height:{type:String,default:"80"}},data:function(){return{styleList:[],styleText:new S.a({font:"12px Calibri,sans-serif",fill:new C.a({color:"#000"}),stroke:new M.a({color:"#fff",width:3})}),styleBase:new P.c({stroke:new M.a({color:T()("#ba68c8",.1),width:2}),fill:new C.a({color:"rgba(255,255,255,0.5)"}),text:new S.a({font:"12px Calibri,sans-serif",fill:new C.a({color:"#000"}),stroke:new M.a({color:"#fff",width:3})})}),colors:k.a.palette.sunSet,strokeBorder:new M.a({color:T()("#fff",.5),width:2}),legendControl:null,rangesCount:[],rangesIncidence:[],ranges:[]}},computed:{mapStyle:function(){return{height:"".concat(this.height,"vh")}},theme:function(){return this.$store.state.theme}},mounted:function(){},methods:{createStyle:function(){var style,e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.styleList.find((function(r){return r.name===e.theme&&r.over===t}));return void 0!==r?r.style:(style=t?new P.c({fill:new C.a({color:T()(_.a["[data-theme=".concat(this.theme,"]")].primary,.6)}),stroke:new M.a({color:T()(_.a["[data-theme=".concat(this.theme,"]")].primary,.9),width:.3}),text:this.styleText}):new P.c({fill:new C.a({color:T()(_.a["[data-theme=".concat(this.theme,"]")].primary,.2)}),stroke:new M.a({color:T()(_.a["[data-theme=".concat(this.theme,"]")].primary,.9),width:.3}),text:this.styleText}),this.styleList.push({name:this.theme,over:t,style:style}),style)},generateRangeClass:function(e){var t=this.$ss.max(e),r=this.$ss.min(e),n=[],o=Math.log10(t)-Math.log10(r);o<1&&(o+=1);for(var i=r;i<=t;i=Math.round(i*o,2))n.push([i,Math.round(i*o,2)]);return n},generateRangeIncidenceClass:function(e){for(var t=this.$ss.max(e),r=this.$ss.min(e),n=Math.log10(e.length),o=Math.round(1+3.3*n),c=[],i=r;i<=t;i+=Math.round(t/o))c.push([i,i+Math.round(t/o)]);return c},coloringMap:function(e,t){var r=this;if(null!=e){var o=this.fillGray;if(this.incidence){this.ranges=Object(n.a)(this.rangesIncidence);for(var i=0;i<this.rangesIncidence.length;i++)if(t.incidence>=this.rangesIncidence[i][0]&&t.incidence<=this.rangesIncidence[i][1]){o=new C.a({color:T()(this.colors[i],.7)});break}}else{this.ranges=Object(n.a)(this.rangesCount);for(var c=0;c<this.rangesCount.length;c++)if(t.count>=this.rangesCount[c][0]&&t.count<=this.rangesCount[c][1]){o=new C.a({color:T()(this.colors[c],.7)});break}}e.setProperties({count:t.count}),e.setProperties({incidence:t.incidence}),e.setStyle(new P.c({stroke:new M.a({color:T()("#ba68c8",.1),width:1}),fill:o,text:new S.a({text:e.getProperties().name,font:"12px Calibri,sans-serif",fill:new C.a({color:"#000"}),stroke:new M.a({color:"#fff",width:3})})}))}else setTimeout((function(){r.updateFeature(e,t)}),1e3)},setPrintMap:function(map){var e=r(940).default;e.prototype._labels.ptBR={title:"Imprimir",orientation:"Orientação",portrait:"Retrato",landscape:"Paisagem",size:"Tamanho da página",custom:"Tamanho da tela",margin:"Margem",scale:"Escala",legend:"Legenda",north:"Seta norte",mapTitle:"Título do mapa",saveas:"Salvar como...",saveLegend:"Salvar legenda...",copied:"✔ Copiado para a área de transferência",errorMsg:"Não é possível salvar a tela do mapa...",printBt:"Imprimir...",cancel:"Cancelar"};var t=new e({lang:"ptBR"});map.addControl(t)},updatedLegend:function(e,map){var t=this,n=r(873).default,o=r(868).default;if(null!==map){var legend=new n({title:this.incidence?"Incidência":"Ocorrência",margin:5});null!=this.legendControl&&map.removeControl(this.legendControl),this.legendControl=new o({legend:legend,collapsed:!1}),map.addControl(this.legendControl);for(var i=0;i<e.length;i++)legend.addItem({title:"".concat(e[i][0]," - ").concat(e[i][1]),typeGeom:"Point",style:new P.c({image:new O.a({points:4,radius:15,angle:Math.PI/4,stroke:new M.a({color:T()("#ba68c8",.1),width:1}),fill:new C.a({color:T()(this.colors[i],.7)})})})})}else setTimeout((function(){t.updatedRanges(e,map)}),2e3)}}});r(578);function z(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw o}}}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}var j={name:"OlMap",mixins:[I],props:{mapFeatures:{type:Array,required:!0},featureType:{type:String,required:!0},occurrences:{type:Array,required:!0},incidence:{type:Boolean,required:!0},zoom:{type:Number,default:4},zoomOut:{type:Number,default:0}},data:function(){return{source:null,vector:null,tileOSM:null,map:null,features:[],featuresHover:[],showPopover:!1,selectedfeature:null,featureSelected:{},overlayPopup:null}},watch:{mapFeatures:function(e){this.map.getView().setZoom(this.zoom),this.features=Object(n.a)(e),this.updateFeatures(this.features)},occurrences:function(e){this.map.getView().setZoom(this.zoom),this.updatedOccurrences(e)},ranges:function(e){this.updatedLegend(e,this.map)},incidence:function(){this.updateFeature(this.occurrences)}},mounted:function(){this.initiateMap()},methods:{initiateMap:function(){var e=this,t=this.styleBase;this.source=new o.a({features:this.features,style:t}),this.vector=new c.a({source:this.source,style:function(e){return t.getText().setText(e.get("name").toString()),t},wrapX:!1}),this.sourceHover=new o.a({features:this.featuresHover,style:t}),this.vectorHover=new c.a({source:this.sourceHover,style:function(e){return t.getText().setText(e.get("name").toString()),t},wrapX:!1}),this.tileOSM=new l.a({source:new d.a}),this.map=new h.a({target:this.$refs.map,layers:[this.tileOSM,this.vector,this.vectorHover],view:new f.a({projection:"EPSG:4326",center:[-69.6689969,-13.7049651],zoom:this.zoom})});var r=null;this.map.on("pointermove",(function(t){if(e.sourceHover.clear(),null!==r&&(r=null),e.map.forEachFeatureAtPixel(t.pixel,(function(e){return r=e,!0})),r){var n=r.clone();n.setStyle(e.styleBase.clone()),n.getStyle().getText().setText(r.get("name").toString()),e.sourceHover.addFeature(n)}})),this.source.on("addfeature",(function(){e.add||(e.$emit("featuresload",!1),e.map.getView().fit(e.features[0].getGeometry()),e.map.getView().animate({zoom:e.map.getView().getZoom()-e.zoomOut}))})),this.map.on("loadend",this.loadend),this.overlayPopup=new v.a({element:this.$refs.popover.$el}),this.map.addOverlay(this.overlayPopup),this.selectedfeature=new w.a({wrapX:!1,style:this.styleBase.clone().getText().setText("Select")}),this.selectedfeature.on("select",(function(t){if(e.showPopover=!1,t.selected.length>0){e.featureSelected=(new m.a).writeFeatureObject(t.selected[0]);var r=t.selected[0].getGeometry().getExtent();e.overlayPopup.setPosition(Object(y.w)(r)),e.$emit("selectedFeature",t.selected[0]),e.showPopover=!0}})),this.map.addInteraction(this.selectedfeature),this.setPrintMap(this.map)},resize:function(){var e=this;setTimeout((function(){e.map.updateSize()}),500)},updateFeatures:function(e){null!==this.source&&this.source.clear();var t={type:"FeatureCollection",name:this.featureType,crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG::4326"}},features:e};this.features=(new m.a).readFeatures(t),this.source.addFeatures(this.features)},updateFeature:function(e){var t,r=null,n=z(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;null!==(r=this.findFeature(o))&&this.coloringMap(r,o)}}catch(e){n.e(e)}finally{n.f()}},findFeature:function(e){return 6===e.ibge_id.toString().length?this.source.forEachFeature((function(t){if(t.getProperties().ibge_id_short===e.ibge_id)return t})):this.source.forEachFeature((function(t){if(t.getProperties().ibge_id===e.ibge_id)return t}))},updatedOccurrences:function(e){var t=this;try{var r=null,n=[],o=[];this.source.forEachFeature((function(e){e.setStyle(t.styleBase),e.getStyle().fill=t.styleBase.fill,e.getStyle().stroke=t.styleBase.stroke,e.setProperties({count:0}),e.setProperties({incidence:0})}));for(var c=0;c<e.length;c++){var l=e[c];null!==(r=this.findFeature(l))&&(r.getProperties().count=l.count,l.incidence=parseFloat((l.count/r.getProperties().populations*1e5).toFixed(2)),r.getProperties().incidence=l.incidence,l.count>0&&(n.push(l.count),o.push(l.incidence))),e.length-1===c&&(this.rangesCount=this.generateRangeClass(n),this.rangesIncidence=this.generateRangeIncidenceClass(o),this.updateFeature(e))}}catch(e){this.$forceUpdate()}},closerPopover:function(){return this.overlayPopup.setPosition(void 0),this.showPopover=!1,this.featureSelected={},!1},loadend:function(){new ResizeObserver(this.resize).observe(this.$refs.container),this.$emit("create-map",this.map),this.map.un("loadend",this.loadend)}}},B=(r(886),r(195)),component=Object(B.a)(j,(function(){var e=this,t=e._self._c;return t("div",{ref:"container"},[t("div",{ref:"map",staticClass:"map",style:e.mapStyle,on:{resize:e.resize}}),e._v(" "),t("OlPopover",{directives:[{name:"show",rawName:"v-show",value:e.showPopover,expression:"showPopover"}],ref:"popover",attrs:{id:"popover",feature:e.featureSelected},on:{close:e.closerPopover}})],1)}),[],!1,null,"41a7d60f",null);t.default=component.exports;installComponents(component,{OlPopover:r(870).default})}}]);